<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DonorNear - Home</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-dark bg-danger">
  <div class="container">
    <a class="navbar-brand" href="index.html">DonorNear</a>
    <div class="ms-auto">
      <a class="nav-link d-inline text-white mx-2" href="index.html">Home</a>
      
      <span id="guestLinks">
        <a class="nav-link d-inline text-white mx-2" href="register.html">Register</a>
        <a class="nav-link d-inline text-white mx-2" href="login.html">Login</a>
      </span>

      <span id="userLinks" style="display: none;">
        <a class="nav-link d-inline text-white mx-2" href="search.html">Find Donors</a>
        <button onclick="handleLogout()" class="btn btn-sm btn-outline-light ms-2">Logout</button>
      </span>
    </div>
  </div>
</nav>

<div class="container text-center mt-5">
  <div class="row text-center mb-5">
    <div class="col-md-4">
      <h5>üìç Location Based</h5>
      <p>Find donors near your GPS coordinates.</p>
    </div>
    <div class="col-md-4">
      <h5>ü©∏ Compatible Groups</h5>
      <p>Filter by specific blood types in real-time.</p>
    </div>
    <div class="col-md-4">
      <h5>üö® Emergency Fast</h5>
      <p>Quick access to donor contact details.</p>
    </div>
  </div>

  <h1 class="text-danger display-4 fw-bold">Find Blood Donors Near You</h1>
  <p class="lead">A secure, location-based donor network.</p>

  <div class="mt-4" id="ctaButtons">
    <a id="regBtn" class="btn btn-danger btn-lg m-2 px-5" href="register.html">Register as Donor</a>
    <a id="findBtn" class="btn btn-outline-danger btn-lg m-2 px-5" href="search.html">Find Donors</a>
  </div>
</div>



<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAhgBBtTeHiFziN6KUBtqLwJu5LZUlrMHo",
    authDomain: "donornear.firebaseapp.com",
    projectId: "donornear",
    storageBucket: "donornear.firebasestorage.app",
    messagingSenderId: "772619025659",
    appId: "1:772619025659:web:fe5f6bada8caeb7a0d045e"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);

  // AUTH OBSERVER: Toggles UI based on login state
  onAuthStateChanged(auth, (user) => {
    const guestLinks = document.getElementById('guestLinks');
    const userLinks = document.getElementById('userLinks');
    const regBtn = document.getElementById('regBtn');

    if (user) {
      // User is logged in
      guestLinks.style.display = 'none';
      userLinks.style.display = 'inline';
      if(regBtn) regBtn.style.display = 'none'; // Hide register button if already a user
    } else {
      // User is logged out
      guestLinks.style.display = 'inline';
      userLinks.style.display = 'none';
    }
  });

  // LOGOUT FUNCTION
  window.handleLogout = function() {
    signOut(auth).then(() => {
      alert("You have been logged out.");
      window.location.reload();
    }).catch((error) => {
      alert("Error logging out: " + error.message);
    });
  };
</script>

</body>
</html>