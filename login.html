<!DOCTYPE html>
<html>
<head>
    <title>Login</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container">

<h2 class="text-danger mt-4">Login</h2>

<form class="mt-3" id="loginForm">
    <input id="email" class="form-control my-2" type="email" placeholder="Email" required>
    <input id="password" class="form-control my-2" type="password" placeholder="Password" required>
    
    <button type="button" onclick="handleLogin()" class="btn btn-danger mt-2 w-100">Login</button>
</form>

<p class="mt-3">Don't have an account? <a href="register.html">Register here</a></p>

<script type="module">
    // 1. Import Firebase Auth functions
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

    // 2. Your Firebase Config
    const firebaseConfig = {
        apiKey: "AIzaSyAhgBBtTeHiFziN6KUBtqLwJu5LZUlrMHo",
        authDomain: "donornear.firebaseapp.com",
        projectId: "donornear",
        storageBucket: "donornear.firebasestorage.app",
        messagingSenderId: "772619025659",
        appId: "1:772619025659:web:fe5f6bada8caeb7a0d045e"
    };

    // 3. Initialize Firebase and Auth
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    window.handleLogin = function() {
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;

        if(!email || !password) {
            alert("Please fill in all fields.");
            return;
        }

        // 4. Firebase Login Logic
        signInWithEmailAndPassword(auth, email, password)
            .then((userCredential) => {
                // Success
                const user = userCredential.user;
                alert("Welcome back! Login successful.");
                window.location.href = "index.html"; // Redirect to home
            })
            .catch((error) => {
                // Handle Errors (e.g., wrong password)
                const errorCode = error.code;
                const errorMessage = error.message;
                alert("Login Error: " + errorMessage);
            });
    }
</script>

</body>
</html>